(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _blacklist_es2015=require("./blacklist_es2015"),_fetcher_es2015Js=require("./fetcher_es2015.js"),_whitelist_es2015Js=require("./whitelist_es2015.js"),blacklist=_blacklist_es2015.Blacklist;exports.blacklist=blacklist;var whitelist=_whitelist_es2015Js.Whitelist;exports.whitelist=whitelist;var fetcher=_fetcher_es2015Js.Fetcher;exports.fetcher=fetcher,function(e,t,s){function i(e){var t=new URL(e.url).hostname;return e.tabId?(chrome.tabs.sendMessage(e.tabId,{action:"addToBlocklist",domain:t},function(t){t&&t.success&&(chrome.browserAction.setBadgeText({text:t.blocklist.length?t.blocklist.length.toString():"",tabId:e.tabId}),t.notified||chrome.notifications.create({type:"basic",title:"Malicious request blocked",iconUrl:"/images/cymon-icon.png",message:"A web request on this page was deemed malicious by Cymon and has been blocked"}))}),"main_frame"==e.type?{redirectUrl:chrome.extension.getURL("/html/redirectPage.html?url="+encodeURIComponent(e.url))}:{cancel:!0}):void 0}function c(){var s=[];return $.each($(e.get()).not(t.get()).get(),function(e,t){s.push("*://"+t+"/*")}),s}function n(){var e=c();chrome.webRequest.onBeforeRequest.removeListener(i),e.length&&chrome.webRequest.onBeforeRequest.addListener(i,{urls:e},["blocking"])}chrome.runtime.onInstalled.addListener(function(){chrome.runtime.sendMessage({action:"fetchEvent"})}),chrome.runtime.onStartup.addListener(function(){chrome.runtime.sendMessage({action:"updateEvent"})}),chrome.runtime.onMessage.addListener(function(t,i,c){switch(t.action){case"updateEvent":n(),c({success:!0});break;case"fetchEvent":s.fetchBlacklist(e),c({success:!0});break;default:c({success:!1})}})}(blacklist,whitelist,fetcher);
},{"./blacklist_es2015":2,"./fetcher_es2015.js":3,"./whitelist_es2015.js":4}],2:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Blacklist=function(){function t(){return c}function e(t){return t&&t.constructor===Array?(c=t,chrome.storage.local.set({blacklist:c}),chrome.runtime.sendMessage({action:"updateEvent"}),!0):!1}function r(t){if(t&&t.constructor===Array){var e={};return $.each(c,function(t,r){e[r]=!0}),$.each(t,function(t,r){e[r]=!0}),c=Object.keys(e),chrome.storage.local.set({blacklist:c}),chrome.runtime.sendMessage({action:"updateEvent"}),!0}return!1}var c=[];return chrome.storage.local.get(function(t){c=t.blacklist||c}),{get:t,set:e,add:r}}();exports.Blacklist=Blacklist;
},{}],3:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Fetcher=function(){function e(e){return new Promise(function(t,n){var c=new XMLHttpRequest;c.open("GET","http://cymoncommunity-dev-wartenuq33.elasticbeanstalk.com/api/nexus/v1/blacklist/domain/"+encodeURIComponent(e)+"/?days="+encodeURIComponent(f)+"&limit=25000"),c.onload=function(){if(200==c.status){var e=[];$.each(JSON.parse(c.response).results,function(t,n){e.push(n.name)}),t(e)}else n(Error(c.statusText))},c.onerror=function(){n(Error("There was an error fetching domains from Cymon."))},c.send()})}function t(t){var n=[];t.set([]),$.each(m,function(e,t){t&&n.push(e)}),n.length&&($.each(n,function(n,c){e(c).then(function(e){t.add(e),chrome.runtime.sendMessage({action:"updateEvent"})})}),this.setLastFetch((new Date).getTime()))}function n(){return g&&clearTimeout(g),g=setTimeout(function(){chrome.runtime.sendMessage({action:"fetchEvent"})},p>0?p+36e5*l-(new Date).getTime():0),!0}function c(e){return e&&"object"==typeof e?(m=e,chrome.storage.sync.set({tags:m}),chrome.runtime.sendMessage({action:"fetchEvent"}),!0):!1}function r(e){return e&&"number"==typeof e&&e%1===0&&e>0&&3>=e?(f=e,chrome.storage.sync.set({fetchLookback:f}),!0):!1}function o(e){return e&&"number"==typeof e&&e%1===0&&e>0&&24>=e?(l=e,chrome.storage.sync.set({fetchInterval:l}),this.updateFetchTimer(),!0):!1}function s(e){return e&&"number"==typeof e&&e%1==0?(p=e,chrome.storage.sync.set({lastFetch:p}),this.updateFetchTimer(),!0):!1}function a(){return m}function i(){return f}function u(){return l}function h(){return p}var m={blacklist:!1,botnet:!1,dnsbl:!0,"malicious activity":!1,malware:!1,phishing:!1,spam:!1},f=1,l=24,p=0,g=0;return chrome.storage.sync.get(function(e){m=e.tags||m,f=e.fetchLookback||f,l=e.fetchInterval||l,p=e.lastFetch||p}),{fetchBlacklist:t,updateFetchTimer:n,setTags:c,setFetchLookback:r,setFetchInterval:o,setLastFetch:s,getTags:a,getFetchLookback:i,getFetchInterval:u,getLastFetch:h}}();exports.Fetcher=Fetcher;
},{}],4:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Whitelist=function(){function e(){return s}function t(e){return"string"==typeof e&&-1==s.indexOf(e)?(s.push(e),chrome.storage.sync.set({whitelist:s}),chrome.runtime.sendMessage({action:"updateEvent"}),!0):!1}function n(e){if("string"==typeof e){var t=s.indexOf(e);return-1!=t?(s.splice(t,1),chrome.storage.sync.set({whitelist:s}),chrome.runtime.sendMessage({action:"updateEvent"}),!0):!1}return!1}function r(){return s=[],chrome.storage.sync.set({whitelist:[]}),chrome.runtime.sendMessage({action:"updateEvent"}),!0}var s=[];return chrome.storage.sync.get(function(e){s=e.whitelist||s}),{get:e,add:t,remove:n,clear:r}}();exports.Whitelist=Whitelist;
},{}]},{},[1])


//# sourceMappingURL=bundle.map.json