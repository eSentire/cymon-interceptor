(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}var _blacklistJs=require("./blacklist.js"),_blacklistJs2=_interopRequireDefault(_blacklistJs),_fetcherJs=require("./fetcher.js"),_fetcherJs2=_interopRequireDefault(_fetcherJs),_whitelistJs=require("./whitelist.js"),_whitelistJs2=_interopRequireDefault(_whitelistJs),app={blacklist:_blacklistJs2["default"],whitelist:_whitelistJs2["default"],fetcher:_fetcherJs2["default"]};!function(e,t,s){function i(e){var t=new URL(e.url).hostname;return e.tabId>=0?(chrome.tabs.sendMessage(e.tabId,{action:"addToBlocklist",domain:t},function(t){t&&t.success&&(chrome.browserAction.setBadgeText({text:t.blocklist.length?t.blocklist.length.toString():"",tabId:e.tabId}),t.notified||chrome.notifications.create({type:"basic",title:"Malicious request blocked",iconUrl:"/images/cymon-icon.png",message:"A web request on this page was deemed malicious by Cymon and has been blocked"}))}),"main_frame"==e.type?{redirectUrl:chrome.extension.getURL("/html/redirectPage.html?url="+encodeURIComponent(e.url))}:{cancel:!0}):void 0}function c(){var s=[];return $.each($(e.get()).not(t.get()).get(),function(e,t){s.push("*://"+t+"/*")}),s}function r(){var e=c();chrome.webRequest.onBeforeRequest.removeListener(i),e.length&&chrome.webRequest.onBeforeRequest.addListener(i,{urls:e},["blocking"])}chrome.runtime.onMessage.addListener(function(t,i,c){switch(t.action){case"updateEvent":r(),c({success:!0});break;case"fetchEvent":s.fetchBlacklist(e),c({success:!0});break;default:c({success:!1})}})}(app.blacklist,app.whitelist,app.fetcher),window.app=app;
},{"./blacklist.js":2,"./fetcher.js":3,"./whitelist.js":4}],2:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=function(){function e(){return JSON.parse(JSON.stringify(n))}function t(){n=[],chrome.storage.local.set({blacklist:n}),chrome.runtime.sendMessage({action:"updateEvent"})}function r(e){if(e&&e.constructor===Array){var t={};return $.each(n,function(e,r){t[r]=!0}),$.each(e,function(e,r){t[r]=!0}),n=Object.keys(t),chrome.storage.local.set({blacklist:n}),chrome.runtime.sendMessage({action:"updateEvent"}),!0}return!1}var n=[];return chrome.storage.local.get(function(e){n=e.blacklist||n}),{get:e,clear:t,add:r}}(),module.exports=exports["default"];
},{}],3:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=function(){function e(e){return e&&"object"==typeof e&&Object.keys(l).sort().toString()===Object.keys(e).sort().toString()&&JSON.stringify(l)!=JSON.stringify(e)?(l=JSON.parse(JSON.stringify(e)),chrome.storage.sync.set({tags:l}),!0):!1}function t(e){return e&&"number"==typeof e&&e!=p&&e%1===0&&e>0&&3>=e?(p=e,chrome.storage.sync.set({fetchLookback:p}),!0):!1}function n(e,t){return new Promise(function(n,r){var s=new XMLHttpRequest;s.open("GET","http://cymoncommunity-dev-wartenuq33.elasticbeanstalk.com/api/nexus/v1/blacklist/domain/"+encodeURIComponent(e)+"/?days="+encodeURIComponent(p)+"&limit=25000"),s.onload=function(){if(200==s.status){var e=[];$.each(JSON.parse(s.response).results,function(t,n){e.push(n.name)}),n({domains:e,timestamp:t})}else r(Error(s.statusText))},s.onerror=function(){r(Error("There was an error fetching domains from Cymon."))},s.send()})}function r(e){var t=[];e.clear(),$.each(l,function(e,n){n&&t.push(e)}),t.length&&(b=(new Date).getTime(),$.each(t,function(t,r){n(r,b).then(function(t){t.timestamp==b&&(e.add(t.domains),chrome.runtime.sendMessage({action:"updateEvent"}))})}),this.setLastFetch((new Date).getTime()))}function s(){y&&clearTimeout(y),y=setTimeout(function(){chrome.runtime.sendMessage({action:"fetchEvent"})},v>0?v+36e5*d-(new Date).getTime():0)}function o(n,r,s){var o=e(n),c=t(r);this.setFetchInterval(s),(o||c)&&chrome.runtime.sendMessage({action:"fetchEvent"})}function c(t){var n=e(t);return n&&chrome.runtime.sendMessage({action:"fetchEvent"}),n}function a(e){var n=t(e);return n&&chrome.runtime.sendMessage({action:"fetchEvent"}),n}function i(e){return e&&"number"==typeof e&&e%1===0&&e>0&&24>=e?(d=e,chrome.storage.sync.set({fetchInterval:d}),this.updateFetchTimer(),!0):!1}function u(e){return e&&"number"==typeof e&&e%1==0?(v=e,chrome.storage.sync.set({lastFetch:v}),this.updateFetchTimer(),!0):!1}function m(){return JSON.parse(JSON.stringify(l))}function h(){return p}function f(){return d}function g(){return v}var l={blacklist:!1,botnet:!1,dnsbl:!0,"malicious activity":!1,malware:!1,phishing:!1,spam:!1},p=1,d=24,v=0,y=0,b=0;return chrome.storage.sync.get(function(e){l=e.tags||l,p=e.fetchLookback||p,d=e.fetchInterval||d,v=e.lastFetch||v,s()}),{fetchBlacklist:r,updateFetchTimer:s,save:o,setTags:c,setFetchLookback:a,setFetchInterval:i,setLastFetch:u,getTags:m,getFetchLookback:h,getFetchInterval:f,getLastFetch:g}}(),module.exports=exports["default"];
},{}],4:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=function(){function e(){return JSON.parse(JSON.stringify(s))}function t(e){return"string"==typeof e&&-1==s.indexOf(e)?(s.push(e),chrome.storage.sync.set({whitelist:s}),chrome.runtime.sendMessage({action:"updateEvent"}),!0):!1}function n(e){if("string"==typeof e){var t=s.indexOf(e);return-1!=t?(s.splice(t,1),chrome.storage.sync.set({whitelist:s}),chrome.runtime.sendMessage({action:"updateEvent"}),!0):!1}return!1}function r(){s=[],chrome.storage.sync.set({whitelist:[]}),chrome.runtime.sendMessage({action:"updateEvent"})}var s=[];return chrome.storage.sync.get(function(e){s=e.whitelist||s,chrome.runtime.sendMessage({action:"updateEvent"})}),{get:e,add:t,remove:n,clear:r}}(),module.exports=exports["default"];
},{}]},{},[1])


//# sourceMappingURL=bundle.map.json